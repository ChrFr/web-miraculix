{% extends 'orcaserver/base.html' %}
{% load static %}

{% block content %}
<h4> Select a project </h4>
<table class="table table-striped select" id="projects">
  <thead>
    <tr>
      <th style="display: none;">ID</th>
      <th>Name</th>
      <th>Description</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  {% for project in projects %}
    <tr onclick="highlightRow(this)" data-id="{{ project.id }}">
      <td style="display: none;"> {{ project.id }} </td>
      <td> {{ project.name }} </td>
      <td> {{ project.description }} </td>
      <td>
        <a href="/projects/change/{{project.id}}/" title="Edit Project"><i class="fa fa-pencil" style="font-size: 1.5em;"></i></a>
      </td>
    </tr>
  {% endfor %}
  </tbody>
</table>
<form action='' method="post">
  {% csrf_token %}
  <input name="project" style="display: None"/>
  <button class="btn btn-primary" type="submit" name="select" value="select" title="Set selected project as active" style="margin-right: 1em;">
    <i class="fa fa-star-o"></i>Select
  </button>
  <button class="btn btn-success" href="/projects/create/" title="Add a new Project">
    <i class="fa fa-plus"></i>Add
  </button>
  <button class="btn btn-danger" type="submit" value="delete" name="delete" title="Remove selected project" style="float: right;">
    <i class="fa fa-trash-o"></i>Remove
  </button>
</form>

<script>
  var table = document.getElementById('projects'),
      projectInput = document.querySelector('input[name="project"]');
  // highlight row in table on click
  function highlightRow(target){
    for(row of table.rows){
      if (row!=target) row.classList.remove('selected');
    }
    target.classList.toggle('selected');
    projectInput.value = target.classList.contains('selected') ? target.dataset['id'] : null;
  }
</script>

{% endblock %}